{"ast":null,"code":"import React,{useState}from'react';import{loadStripe}from'@stripe/stripe-js';import{Elements,CardElement,useStripe,useElements}from'@stripe/react-stripe-js';import'./Payment.css';// Load Stripe with your publishable key\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const stripePromise=loadStripe('pk_test_51QMcBgELN7EfHzd3PuMN61SJzcRKjeVSdWcPrHdCc7sekN2tpGqKdyHYANvQtOJFvasBy8cQ2jEt0XBJslYob6Pd00d0C6coWb');function Payment(_ref){let{totalAmountInCents}=_ref;const[isProcessing,setIsProcessing]=useState(false);return/*#__PURE__*/_jsxs(\"div\",{className:\"payment-container\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Payment\"}),/*#__PURE__*/_jsx(Elements,{stripe:stripePromise,children:/*#__PURE__*/_jsx(CheckoutForm,{totalAmountInCents:totalAmountInCents,isProcessing:isProcessing,setIsProcessing:setIsProcessing})})]});}function CheckoutForm(_ref2){let{totalAmountInCents,isProcessing,setIsProcessing}=_ref2;const stripe=useStripe();const elements=useElements();const[errorMessage,setErrorMessage]=useState('');const handleSubmit=async event=>{event.preventDefault();setIsProcessing(true);if(!stripe||!elements)return;const cardElement=elements.getElement(CardElement);try{const response=await fetch('http://localhost:5000/api/payments/create-payment-intent',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({amount:totalAmountInCents})// Dynamic amount passed here\n});const data=await response.json();if(!data.clientSecret){setErrorMessage(\"Failed to fetch client secret\");setIsProcessing(false);return;}const paymentResult=await stripe.confirmCardPayment(data.clientSecret,{payment_method:{card:cardElement}});if(paymentResult.error){setErrorMessage(paymentResult.error.message);}else{alert('Payment successful!');}}catch(error){setErrorMessage('Payment failed. Try again.');}finally{setIsProcessing(false);}};return/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"checkout-form\",children:[/*#__PURE__*/_jsx(CardElement,{className:\"card-element\",options:{style:{base:{fontSize:'16px',color:'#424770','::placeholder':{color:'#aab7c4'}},invalid:{color:'#9e2146'}},hidePostalCode:true}}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:!stripe||isProcessing,className:\"payment-button\",children:isProcessing?'Processing...':'Pay Now'}),errorMessage&&/*#__PURE__*/_jsx(\"p\",{className:\"error-message\",children:errorMessage})]});}export default Payment;","map":{"version":3,"names":["React","useState","loadStripe","Elements","CardElement","useStripe","useElements","jsx","_jsx","jsxs","_jsxs","stripePromise","Payment","_ref","totalAmountInCents","isProcessing","setIsProcessing","className","children","stripe","CheckoutForm","_ref2","elements","errorMessage","setErrorMessage","handleSubmit","event","preventDefault","cardElement","getElement","response","fetch","method","headers","body","JSON","stringify","amount","data","json","clientSecret","paymentResult","confirmCardPayment","payment_method","card","error","message","alert","onSubmit","options","style","base","fontSize","color","invalid","hidePostalCode","type","disabled"],"sources":["/Users/pradnya/DePaul Courses/CSC 436 Web Applications/ecommerce-app/frontend/src/components/Payment.js"],"sourcesContent":["import React, { useState } from 'react';\nimport { loadStripe } from '@stripe/stripe-js';\nimport { Elements, CardElement, useStripe, useElements } from '@stripe/react-stripe-js';\nimport './Payment.css';\n\n// Load Stripe with your publishable key\nconst stripePromise = loadStripe('pk_test_51QMcBgELN7EfHzd3PuMN61SJzcRKjeVSdWcPrHdCc7sekN2tpGqKdyHYANvQtOJFvasBy8cQ2jEt0XBJslYob6Pd00d0C6coWb');\n\nfunction Payment({ totalAmountInCents }) {\n  const [isProcessing, setIsProcessing] = useState(false);\n\n  return (\n    <div className=\"payment-container\">\n      <h2>Payment</h2>\n      <Elements stripe={stripePromise}>\n        <CheckoutForm\n          totalAmountInCents={totalAmountInCents}\n          isProcessing={isProcessing}\n          setIsProcessing={setIsProcessing}\n        />\n      </Elements>\n    </div>\n  );\n}\n\nfunction CheckoutForm({ totalAmountInCents, isProcessing, setIsProcessing }) {\n  const stripe = useStripe();\n  const elements = useElements();\n  const [errorMessage, setErrorMessage] = useState('');\n\n  const handleSubmit = async (event) => {\n    event.preventDefault();\n    setIsProcessing(true);\n\n    if (!stripe || !elements) return;\n\n    const cardElement = elements.getElement(CardElement);\n\n    try {\n      const response = await fetch('http://localhost:5000/api/payments/create-payment-intent', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ amount: totalAmountInCents }), // Dynamic amount passed here\n      });\n\n      const data = await response.json();\n\n      if (!data.clientSecret) {\n        setErrorMessage(\"Failed to fetch client secret\");\n        setIsProcessing(false);\n        return;\n      }\n\n      const paymentResult = await stripe.confirmCardPayment(data.clientSecret, {\n        payment_method: { card: cardElement },\n      });\n\n      if (paymentResult.error) {\n        setErrorMessage(paymentResult.error.message);\n      } else {\n        alert('Payment successful!');\n      }\n    } catch (error) {\n      setErrorMessage('Payment failed. Try again.');\n    } finally {\n      setIsProcessing(false);\n    }\n  };\n\n  return (\n    <form onSubmit={handleSubmit} className=\"checkout-form\">\n      <CardElement\n        className=\"card-element\"\n        options={{\n          style: {\n            base: {\n              fontSize: '16px',\n              color: '#424770',\n              '::placeholder': { color: '#aab7c4' },\n            },\n            invalid: { color: '#9e2146' },\n          },\n          hidePostalCode: true,\n        }}\n      />\n      <button type=\"submit\" disabled={!stripe || isProcessing} className=\"payment-button\">\n        {isProcessing ? 'Processing...' : 'Pay Now'}\n      </button>\n      {errorMessage && <p className=\"error-message\">{errorMessage}</p>}\n    </form>\n  );\n}\n\nexport default Payment;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}